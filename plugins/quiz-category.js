const quizzes = {
    geografia: [
        {
            question: "üåç Qual √® la capitale della Francia?",
            options: ["Parigi", "Londra", "Berlino", "Madrid"],
            correct: 0,
            explanation: "Parigi √® la capitale della Francia, famosa per la Torre Eiffel! üóº"
        },
        {
            question: "üåç Qual √® il fiume pi√π lungo del mondo?",
            options: ["Nilo", "Amazzonia", "Yangtze", "Mississippi"],
            correct: 0,
            explanation: "Il Nilo √® lungo circa 6.650 km! üèûÔ∏è"
        },
        {
            question: "üåç In quale continente si trova l'Egitto?",
            options: ["Africa", "Asia", "Europa", "Oceania"],
            correct: 0,
            explanation: "L'Egitto si trova in Africa, famoso per le piramidi! üî∫"
        },
        {
            question: "üåç Qual √® l'oceano pi√π grande?",
            options: ["Pacifico", "Atlantico", "Indiano", "Artico"],
            correct: 0,
            explanation: "L'Oceano Pacifico copre circa il 46% della superficie oceanica mondiale! üåä"
        },
        {
            question: "üåç Qual √® la montagna pi√π alta del mondo?",
            options: ["Everest", "K2", "Kilimanjaro", "Monte Bianco"],
            correct: 0,
            explanation: "Il Monte Everest √® alto 8.849 metri! ‚õ∞Ô∏è"
        },
        {
            question: "üåç Qual √® la capitale dell'Australia?",
            options: ["Canberra", "Sydney", "Melbourne", "Brisbane"],
            correct: 0,
            explanation: "Molti pensano sia Sydney, ma la capitale √® Canberra! üá¶üá∫"
        },
        {
            question: "üåç Quale deserto √® il pi√π grande del mondo?",
            options: ["Sahara", "Gobi", "Atacama", "Kalahari"],
            correct: 0,
            explanation: "Il Sahara copre 9 milioni di km¬≤! üèúÔ∏è"
        },
        {
            question: "üåç Quale paese ha pi√π abitanti?",
            options: ["India", "Cina", "USA", "Indonesia"],
            correct: 0,
            explanation: "L'India ha superato la Cina nel 2023! üë•"
        }
    ],
    
    cinema: [
        {
            question: "üé¨ Chi interpreta Spider-Man nei film pi√π recenti?",
            options: ["Tom Holland", "Tobey Maguire", "Andrew Garfield", "Chris Evans"],
            correct: 0,
            explanation: "Tom Holland √® l'attuale Spider-Man nel MCU! üï∑Ô∏è"
        },
        {
            question: "üé¨ In quale serie Netflix si trova il 'Sottosopra'?",
            options: ["Stranger Things", "The Witcher", "Mercoled√¨", "You"],
            correct: 0,
            explanation: "Il Sottosopra (Upside Down) √® in Stranger Things! üëæ"
        },
        {
            question: "üé¨ Chi ha diretto 'Inception'?",
            options: ["Christopher Nolan", "Steven Spielberg", "Tarantino", "Scorsese"],
            correct: 0,
            explanation: "Christopher Nolan √® il maestro dei plot twist! üé•"
        },
        {
            question: "üé¨ Come si chiama il drago pi√π grande di Daenerys?",
            options: ["Drogon", "Viserion", "Rhaegal", "Balerion"],
            correct: 0,
            explanation: "Drogon √® il drago nero, il pi√π potente! üêâ"
        },
        {
            question: "üé¨ Qual √® il vero nome di Iron Man?",
            options: ["Tony Stark", "Bruce Wayne", "Peter Parker", "Steve Rogers"],
            correct: 0,
            explanation: "Tony Stark √® il genio miliardario! ü§ñ"
        },
        {
            question: "üé¨ In che anno √® uscito il primo Harry Potter?",
            options: ["2001", "2000", "1999", "2002"],
            correct: 0,
            explanation: "Harry Potter e la Pietra Filosofale usc√¨ nel 2001! ‚ö°"
        },
        {
            question: "üé¨ Chi √® il regista di Avatar?",
            options: ["James Cameron", "Peter Jackson", "Ridley Scott", "Denis Villeneuve"],
            correct: 0,
            explanation: "James Cameron ha diretto anche Titanic! üåä"
        },
        {
            question: "üé¨ Quanti film ci sono nella saga Fast & Furious?",
            options: ["10+", "7", "5", "12"],
            correct: 0,
            explanation: "Ci sono pi√π di 10 film della saga! üèéÔ∏è"
        }
    ],
    
    videogiochi: [
        {
            question: "üéÆ In quale gioco costruisci con blocchi cubici?",
            options: ["Minecraft", "Fortnite", "Roblox", "Terraria"],
            correct: 0,
            explanation: "Minecraft √® il gioco pi√π venduto di sempre! ‚õèÔ∏è"
        },
        {
            question: "üéÆ Come si chiama l'idraulico protagonista di Nintendo?",
            options: ["Mario", "Luigi", "Wario", "Yoshi"],
            correct: 0,
            explanation: "It's-a me, Mario! üçÑ"
        },
        {
            question: "üéÆ Quale di questi NON √® un Pok√©mon?",
            options: ["Digimon", "Pikachu", "Charizard", "Mewtwo"],
            correct: 0,
            explanation: "Digimon √® un franchise separato! ‚ö°"
        },
        {
            question: "üéÆ In Fortnite, come si chiama la modalit√† principale?",
            options: ["Battle Royale", "Salva il Mondo", "Arena", "Creativa"],
            correct: 0,
            explanation: "Battle Royale con 100 giocatori! üéØ"
        },
        {
            question: "üéÆ Qual √® la console portatile di Nintendo?",
            options: ["Nintendo Switch", "PS Vita", "Xbox Portable", "Game Boy"],
            correct: 0,
            explanation: "Lo Switch √® portatile e da tavolo! üéÆ"
        },
        {
            question: "üéÆ Chi √® il protagonista di The Legend of Zelda?",
            options: ["Link", "Zelda", "Ganondorf", "Navi"],
            correct: 0,
            explanation: "Link √® l'eroe, Zelda √® la principessa! ‚öîÔ∏è"
        },
        {
            question: "üéÆ In quale gioco si combatte con le carte?",
            options: ["Hearthstone", "Valorant", "CS:GO", "Apex Legends"],
            correct: 0,
            explanation: "Hearthstone √® il card game di Blizzard! üÉè"
        },
        {
            question: "üéÆ Quale gioco ha la modalit√† 'Impostor'?",
            options: ["Among Us", "Fall Guys", "Phasmophobia", "Dead by Daylight"],
            correct: 0,
            explanation: "Among Us ha spopolato nel 2020! üî¥"
        }
    ],
    
    musica: [
        {
            question: "üéµ Chi canta 'Blinding Lights'?",
            options: ["The Weeknd", "Drake", "Post Malone", "Travis Scott"],
            correct: 0,
            explanation: "Blinding Lights ha battuto record su Spotify! üé§"
        },
        {
            question: "üéµ Qual √® il vero nome di Eminem?",
            options: ["Marshall Mathers", "Curtis Jackson", "Calvin Broadus", "Andre Young"],
            correct: 0,
            explanation: "Marshall Bruce Mathers III, aka Slim Shady! üéß"
        },
        {
            question: "üéµ Quale band ha fatto 'Bohemian Rhapsody'?",
            options: ["Queen", "The Beatles", "Led Zeppelin", "Pink Floyd"],
            correct: 0,
            explanation: "Queen con Freddie Mercury nel 1975! üëë"
        },
        {
            question: "üéµ Chi √® la 'Bad Guy'?",
            options: ["Billie Eilish", "Ariana Grande", "Taylor Swift", "Dua Lipa"],
            correct: 0,
            explanation: "Billie Eilish ha vinto 5 Grammy! üèÜ"
        },
        {
            question: "üéµ Quale rapper italiano viene da Milano?",
            options: ["Tutti e tre", "Sfera Ebbasta", "Ghali", "Marracash"],
            correct: 0,
            explanation: "Sfera, Ghali e Marracash sono tutti milanesi! üáÆüáπ"
        },
        {
            question: "üéµ Chi ha cantato 'Shape of You'?",
            options: ["Ed Sheeran", "Justin Bieber", "Shawn Mendes", "Harry Styles"],
            correct: 0,
            explanation: "Ed Sheeran ha fatto il tormentone del 2017! üé∏"
        },
        {
            question: "üéµ Quale gruppo K-Pop √® pi√π famoso?",
            options: ["BTS", "BlackPink", "EXO", "TWICE"],
            correct: 0,
            explanation: "BTS ha conquistato il mondo! üåç"
        },
        {
            question: "üéµ Chi canta 'Lucide (Letra)'?",
            options: ["Shiva", "Capo Plaza", "Geolier", "Lazza"],
            correct: 0,
            explanation: "Shiva ha fatto questo successo! üéµ"
        }
    ],
    
    scienza: [
        {
            question: "üî¨ Qual √® il pianeta pi√π vicino al Sole?",
            options: ["Mercurio", "Venere", "Terra", "Marte"],
            correct: 0,
            explanation: "Mercurio √® il pi√π piccolo e vicino! ‚òÄÔ∏è"
        },
        {
            question: "üî¨ Quale gas respiriamo per vivere?",
            options: ["Ossigeno", "Azoto", "Anidride carbonica", "Idrogeno"],
            correct: 0,
            explanation: "L'ossigeno (O‚ÇÇ) √® essenziale! üí®"
        },
        {
            question: "üî¨ Quanti sono i pianeti del Sistema Solare?",
            options: ["8", "7", "9", "10"],
            correct: 0,
            explanation: "Plutone √® stato declassato nel 2006! ü™ê"
        },
        {
            question: "üî¨ Cosa studia la biologia?",
            options: ["La vita", "Le stelle", "I numeri", "La chimica"],
            correct: 0,
            explanation: "La biologia studia gli organismi viventi! üß¨"
        },
        {
            question: "üî¨ Qual √® l'animale terrestre pi√π veloce?",
            options: ["Ghepardo", "Leone", "Leopardo", "Tigre"],
            correct: 0,
            explanation: "Il ghepardo raggiunge 120 km/h! üêÜ"
        },
        {
            question: "üî¨ Qual √® l'elemento pi√π abbondante nell'universo?",
            options: ["Idrogeno", "Ossigeno", "Carbonio", "Elio"],
            correct: 0,
            explanation: "L'idrogeno rappresenta il 75% della materia! ‚öõÔ∏è"
        },
        {
            question: "üî¨ Quante ossa ha il corpo umano?",
            options: ["206", "250", "180", "300"],
            correct: 0,
            explanation: "Un adulto ha 206 ossa! ü¶¥"
        },
        {
            question: "üî¨ Qual √® la velocit√† della luce?",
            options: ["300.000 km/s", "150.000 km/s", "500.000 km/s", "200.000 km/s"],
            correct: 0,
            explanation: "La luce viaggia a ~300.000 km al secondo! üí°"
        }
    ],
    
    sport: [
        {
            question: "‚öΩ Chi ha vinto pi√π Palloni d'Oro?",
            options: ["Lionel Messi", "Cristiano Ronaldo", "Neymar", "Mbapp√©"],
            correct: 0,
            explanation: "Messi ha vinto 8 Palloni d'Oro! ‚öΩ"
        },
        {
            question: "‚öΩ In quale sport si usa una racchetta e pallina gialla?",
            options: ["Tennis", "Badminton", "Squash", "Ping Pong"],
            correct: 0,
            explanation: "Il tennis con le palline gialle! üéæ"
        },
        {
            question: "‚öΩ Quanti giocatori in campo nel calcio?",
            options: ["11", "10", "12", "9"],
            correct: 0,
            explanation: "11 giocatori per squadra! ‚öΩ"
        },
        {
            question: "‚öΩ Chi √® 'Il Re' del basket NBA?",
            options: ["LeBron James", "Michael Jordan", "Kobe Bryant", "Curry"],
            correct: 0,
            explanation: "LeBron James aka 'King James'! üèÄ"
        },
        {
            question: "‚öΩ Dove si sono svolte le Olimpiadi 2024?",
            options: ["Parigi", "Tokyo", "Los Angeles", "Londra"],
            correct: 0,
            explanation: "Parigi 2024, 100 anni dopo il 1924! üèÖ"
        },
        {
            question: "‚öΩ Quale squadra ha vinto pi√π Champions League?",
            options: ["Real Madrid", "Milan", "Barcelona", "Bayern"],
            correct: 0,
            explanation: "Il Real Madrid ne ha vinte 14! üèÜ"
        },
        {
            question: "‚öΩ Chi √® il calciatore pi√π pagato al mondo?",
            options: ["Cristiano Ronaldo", "Messi", "Neymar", "Mbapp√©"],
            correct: 0,
            explanation: "Cristiano guadagna oltre 200 milioni! üí∞"
        },
        {
            question: "‚öΩ Quanti set si giocano nel tennis?",
            options: ["3 o 5", "2 o 4", "Solo 3", "Solo 5"],
            correct: 0,
            explanation: "Negli Slam maschili si giocano 5 set! üéæ"
        }
    ],
    
    tecnologia: [
        {
            question: "üíª Chi ha fondato Apple?",
            options: ["Steve Jobs", "Bill Gates", "Elon Musk", "Zuckerberg"],
            correct: 0,
            explanation: "Steve Jobs ha co-fondato Apple nel 1976! üçé"
        },
        {
            question: "üíª Quale social ha l'uccellino blu?",
            options: ["Twitter (X)", "Facebook", "Instagram", "TikTok"],
            correct: 0,
            explanation: "Twitter, ora X, aveva l'uccellino! üê¶"
        },
        {
            question: "üíª Cosa significa 'AI'?",
            options: ["Intelligenza Artificiale", "Apple Intelligence", "Auto Internet", "Advanced Interface"],
            correct: 0,
            explanation: "AI = Artificial Intelligence! ü§ñ"
        },
        {
            question: "üíª Quale azienda produce l'iPhone?",
            options: ["Apple", "Samsung", "Google", "Huawei"],
            correct: 0,
            explanation: "Apple produce iPhone dal 2007! üì±"
        },
        {
            question: "üíª Come si chiama l'assistente di Amazon?",
            options: ["Alexa", "Siri", "Google Assistant", "Cortana"],
            correct: 0,
            explanation: "Alexa nei dispositivi Echo! üîä"
        },
        {
            question: "üíª Quale social √® cinese?",
            options: ["TikTok", "Instagram", "Snapchat", "Twitter"],
            correct: 0,
            explanation: "TikTok √® di ByteDance (Cina)! üéµ"
        },
        {
            question: "üíª Quanti GB ha 1 TB?",
            options: ["1000", "500", "100", "2000"],
            correct: 0,
            explanation: "1 Terabyte = 1000 Gigabyte! üíæ"
        },
        {
            question: "üíª Chi ha fondato Tesla?",
            options: ["Elon Musk", "Jeff Bezos", "Bill Gates", "Steve Jobs"],
            correct: 0,
            explanation: "Elon Musk ha reso Tesla famosa! ‚ö°"
        }
    ]
}

// Esporta i quiz per usarli in altri file
export { quizzes }

if (!global.activeQuizzes) global.activeQuizzes = {}

let handler = async (m, { conn, args, text }) => {
    const category = args[0] || text
    const chatId = m.chat
    const userId = m.sender
    const quizKey = `${chatId}_${userId}`

    if (!category) {
        return m.reply('‚ùå Categoria non specificata!')
    }

    if (!quizzes[category]) {
        return m.reply('‚ùå Categoria non valida! Usa: geografia, cinema, videogiochi, musica, scienza, sport, tecnologia')
    }

    // Controlla se c'√® gi√† un quiz attivo
    if (global.activeQuizzes[quizKey]) {
        return m.reply('‚ùå Hai gi√† un quiz attivo! Rispondi prima alla domanda corrente.')
    }

    // Prendi un quiz casuale dalla categoria
    const categoryQuizzes = quizzes[category]
    const quiz = categoryQuizzes[Math.floor(Math.random() * categoryQuizzes.length)]
    
    // Salva il quiz attivo
    global.activeQuizzes[quizKey] = {
        quiz: quiz,
        category: category,
        startTime: Date.now(),
        attempts: 0
    }

    // Prepara i bottoni con le opzioni
    const buttons = quiz.options.map((option, index) => ({
        buttonId: `.quizanswer ${index}`,
        buttonText: { displayText: option },
        type: 1
    }))

    const categoryIcons = {
        geografia: 'üåç',
        cinema: 'üé¨',
        videogiochi: 'üéÆ',
        musica: 'üéµ',
        scienza: 'üî¨',
        sport: '‚öΩ',
        tecnologia: 'üíª'
    }

    const questionText = `
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   ${categoryIcons[category]} *QUIZ TIME!* ${categoryIcons[category]}   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìö *Categoria:* ${category.toUpperCase()}

‚ùì *Domanda:*
${quiz.question}

‚è±Ô∏è Rispondi velocemente per pi√π XP!
üí∞ Fino a +50 XP
`.trim()

    const buttonMessage = {
        text: questionText,
        footer: 'CriBot Quiz üéÆ',
        buttons: buttons,
        headerType: 1
    }

    await conn.sendMessage(chatId, buttonMessage, { quoted: m })

    // Timeout di 60 secondi
    setTimeout(() => {
        if (global.activeQuizzes[quizKey]) {
            delete global.activeQuizzes[quizKey]
            conn.reply(chatId, '‚è∞ Tempo scaduto! Usa .quiz per riprovare.', m)
        }
    }, 60000)
}

handler.command = /^quizcat$/i
handler.help = ['quizcat <categoria>']
handler.tags = ['game']

export default handler
